```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime
import warnings
warnings.filterwarnings("ignore")
```


```python
df = pd.read_csv('./datasets/fraudTrain.csv')
df.drop('Unnamed: 0',axis=1,inplace=True)
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>trans_date_trans_time</th>
      <th>cc_num</th>
      <th>merchant</th>
      <th>category</th>
      <th>amt</th>
      <th>first</th>
      <th>last</th>
      <th>gender</th>
      <th>street</th>
      <th>city</th>
      <th>...</th>
      <th>lat</th>
      <th>long</th>
      <th>city_pop</th>
      <th>job</th>
      <th>dob</th>
      <th>trans_num</th>
      <th>unix_time</th>
      <th>merch_lat</th>
      <th>merch_long</th>
      <th>is_fraud</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-01 00:00:18</td>
      <td>2703186189652095</td>
      <td>fraud_Rippin, Kub and Mann</td>
      <td>misc_net</td>
      <td>4.97</td>
      <td>Jennifer</td>
      <td>Banks</td>
      <td>F</td>
      <td>561 Perry Cove</td>
      <td>Moravian Falls</td>
      <td>...</td>
      <td>36.0788</td>
      <td>-81.1781</td>
      <td>3495</td>
      <td>Psychologist, counselling</td>
      <td>1988-03-09</td>
      <td>0b242abb623afc578575680df30655b9</td>
      <td>1325376018</td>
      <td>36.011293</td>
      <td>-82.048315</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-01-01 00:00:44</td>
      <td>630423337322</td>
      <td>fraud_Heller, Gutmann and Zieme</td>
      <td>grocery_pos</td>
      <td>107.23</td>
      <td>Stephanie</td>
      <td>Gill</td>
      <td>F</td>
      <td>43039 Riley Greens Suite 393</td>
      <td>Orient</td>
      <td>...</td>
      <td>48.8878</td>
      <td>-118.2105</td>
      <td>149</td>
      <td>Special educational needs teacher</td>
      <td>1978-06-21</td>
      <td>1f76529f8574734946361c461b024d99</td>
      <td>1325376044</td>
      <td>49.159047</td>
      <td>-118.186462</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 00:00:51</td>
      <td>38859492057661</td>
      <td>fraud_Lind-Buckridge</td>
      <td>entertainment</td>
      <td>220.11</td>
      <td>Edward</td>
      <td>Sanchez</td>
      <td>M</td>
      <td>594 White Dale Suite 530</td>
      <td>Malad City</td>
      <td>...</td>
      <td>42.1808</td>
      <td>-112.2620</td>
      <td>4154</td>
      <td>Nature conservation officer</td>
      <td>1962-01-19</td>
      <td>a1a22d70485983eac12b5b88dad1cf95</td>
      <td>1325376051</td>
      <td>43.150704</td>
      <td>-112.154481</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 00:01:16</td>
      <td>3534093764340240</td>
      <td>fraud_Kutch, Hermiston and Farrell</td>
      <td>gas_transport</td>
      <td>45.00</td>
      <td>Jeremy</td>
      <td>White</td>
      <td>M</td>
      <td>9443 Cynthia Court Apt. 038</td>
      <td>Boulder</td>
      <td>...</td>
      <td>46.2306</td>
      <td>-112.1138</td>
      <td>1939</td>
      <td>Patent attorney</td>
      <td>1967-01-12</td>
      <td>6b849c168bdad6f867558c3793159a81</td>
      <td>1325376076</td>
      <td>47.034331</td>
      <td>-112.561071</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 00:03:06</td>
      <td>375534208663984</td>
      <td>fraud_Keeling-Crist</td>
      <td>misc_pos</td>
      <td>41.96</td>
      <td>Tyler</td>
      <td>Garcia</td>
      <td>M</td>
      <td>408 Bradley Rest</td>
      <td>Doe Hill</td>
      <td>...</td>
      <td>38.4207</td>
      <td>-79.4629</td>
      <td>99</td>
      <td>Dance movement psychotherapist</td>
      <td>1986-03-28</td>
      <td>a41d7549acf90789359a9aa5346dcb46</td>
      <td>1325376186</td>
      <td>38.674999</td>
      <td>-78.632459</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>




```python
pip install haversine
```

    Collecting haversine
      Downloading haversine-2.7.0-py2.py3-none-any.whl (6.9 kB)
    Installing collected packages: haversine
    Successfully installed haversine-2.7.0
    Note: you may need to restart the kernel to use updated packages.
    

    
    [notice] A new release of pip available: 22.3.1 -> 23.0
    [notice] To update, run: python.exe -m pip install --upgrade pip
    


```python
df.distance
```




    0          48.838332
    1          18.773002
    2          67.236235
    3          59.448672
    4          48.191593
                 ...    
    1296670    74.410630
    1296671    46.667580
    1296672    61.545493
    1296673    52.585258
    1296674    52.104318
    Name: distance, Length: 1296675, dtype: float64




```python
from haversine import haversine, Unit 
df['distance']=0
for i in range(df.shape[0]):
    result = haversine((df['lat'][i],df['long'][i]) , (df['merch_lat'][i], df['merch_long'][i]), unit='mi')
    df['distance'][i]= result
```

- index - 인덱스
- trans_date_trans_time - 트랜잭션 날짜 시간
- cc_num - 신용카드 고객 번호
- merchant - 상인 이름
- category - 상인 카테고리, 범주
- amt - 트랜잭션 양
- first - 카드 소지자의 이름
- last - 카드 소지자의 성
- gender - 신용카드 소지자의 성별
- street - 신용카드 소지자의 주소
- city - 신용카드 소지자의 도시
- state - 신용카드 소지자의 주
- zip - 신용카드 소지자의 zip코드
- lat - 신용카드 소지자의 위도 
- long - 신용카드 소지자의 경도
- city_pop - 신용카드 소지자의 도시인구
- job - 신용카드 소지자의 직업
- dob - 신용카드 소지자의 생년월일
- trans_num - 트랜잭션 번호
- unix_time - Unix 트랜잭션 시간
- merch_lat - 상인의 위도 위치
- merch_long - 상인의 경도 위치
- is_fraud - 이상거래  <--- Target Class


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cc_num</th>
      <th>amt</th>
      <th>zip</th>
      <th>lat</th>
      <th>long</th>
      <th>city_pop</th>
      <th>unix_time</th>
      <th>merch_lat</th>
      <th>merch_long</th>
      <th>is_fraud</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.171920e+17</td>
      <td>7.035104e+01</td>
      <td>4.880067e+04</td>
      <td>3.853762e+01</td>
      <td>-9.022634e+01</td>
      <td>8.882444e+04</td>
      <td>1.349244e+09</td>
      <td>3.853734e+01</td>
      <td>-9.022646e+01</td>
      <td>5.788652e-03</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.308806e+18</td>
      <td>1.603160e+02</td>
      <td>2.689322e+04</td>
      <td>5.075808e+00</td>
      <td>1.375908e+01</td>
      <td>3.019564e+05</td>
      <td>1.284128e+07</td>
      <td>5.109788e+00</td>
      <td>1.377109e+01</td>
      <td>7.586269e-02</td>
    </tr>
    <tr>
      <th>min</th>
      <td>6.041621e+10</td>
      <td>1.000000e+00</td>
      <td>1.257000e+03</td>
      <td>2.002710e+01</td>
      <td>-1.656723e+02</td>
      <td>2.300000e+01</td>
      <td>1.325376e+09</td>
      <td>1.902779e+01</td>
      <td>-1.666712e+02</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.800429e+14</td>
      <td>9.650000e+00</td>
      <td>2.623700e+04</td>
      <td>3.462050e+01</td>
      <td>-9.679800e+01</td>
      <td>7.430000e+02</td>
      <td>1.338751e+09</td>
      <td>3.473357e+01</td>
      <td>-9.689728e+01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.521417e+15</td>
      <td>4.752000e+01</td>
      <td>4.817400e+04</td>
      <td>3.935430e+01</td>
      <td>-8.747690e+01</td>
      <td>2.456000e+03</td>
      <td>1.349250e+09</td>
      <td>3.936568e+01</td>
      <td>-8.743839e+01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.642255e+15</td>
      <td>8.314000e+01</td>
      <td>7.204200e+04</td>
      <td>4.194040e+01</td>
      <td>-8.015800e+01</td>
      <td>2.032800e+04</td>
      <td>1.359385e+09</td>
      <td>4.195716e+01</td>
      <td>-8.023680e+01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.992346e+18</td>
      <td>2.894890e+04</td>
      <td>9.978300e+04</td>
      <td>6.669330e+01</td>
      <td>-6.795030e+01</td>
      <td>2.906700e+06</td>
      <td>1.371817e+09</td>
      <td>6.751027e+01</td>
      <td>-6.695090e+01</td>
      <td>1.000000e+00</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1296675 entries, 0 to 1296674
    Data columns (total 22 columns):
     #   Column                 Non-Null Count    Dtype  
    ---  ------                 --------------    -----  
     0   trans_date_trans_time  1296675 non-null  object 
     1   cc_num                 1296675 non-null  int64  
     2   merchant               1296675 non-null  object 
     3   category               1296675 non-null  object 
     4   amt                    1296675 non-null  float64
     5   first                  1296675 non-null  object 
     6   last                   1296675 non-null  object 
     7   gender                 1296675 non-null  object 
     8   street                 1296675 non-null  object 
     9   city                   1296675 non-null  object 
     10  state                  1296675 non-null  object 
     11  zip                    1296675 non-null  int64  
     12  lat                    1296675 non-null  float64
     13  long                   1296675 non-null  float64
     14  city_pop               1296675 non-null  int64  
     15  job                    1296675 non-null  object 
     16  dob                    1296675 non-null  object 
     17  trans_num              1296675 non-null  object 
     18  unix_time              1296675 non-null  int64  
     19  merch_lat              1296675 non-null  float64
     20  merch_long             1296675 non-null  float64
     21  is_fraud               1296675 non-null  int64  
    dtypes: float64(5), int64(5), object(12)
    memory usage: 217.6+ MB
    


```python
df.isna().sum().sum()
```




    0




```python
## 각 변수의 분포 시각화
df.plot(kind='density', subplots=True, layout=(6,4), sharex=False, legend=True, 
                                            fontsize=1, figsize=(16,24))
plt.show()
```


```python
# trans_num 특별한 값을 나타내지 않는 컬럼으로 보여짐
# 성 이름 컬럼 삭제 cc_num변수를 고유식별자로 사용할 수있기때문
print(df['trans_num'].value_counts())
df = df.drop("trans_num",axis=1)
df = df.drop(['first','last'],axis=1)

```

    0b242abb623afc578575680df30655b9    1
    c85864e7e7cf0be6d1b8597977b8afea    1
    1a8a2a05638a5503cc6bb8d5735efcc1    1
    4556eaf1f7def06eb500325cde4d054e    1
    5e915d9f88bd09cee9655a470d9bc0bd    1
                                       ..
    2d1aa5b21a993788ac19b697598ca44c    1
    b50dd4b47d1ad877874661afba6eb7f6    1
    5ce4e974bf15b7d9f133c6eedb81ceb1    1
    64d601ddeaf4eba8b191bd1859998209    1
    8f7c8e4ab7f25875d753b422917c98c9    1
    Name: trans_num, Length: 1296675, dtype: int64
    


```python
# 상관계수가 높은 변수 확인
plt.figure(figsize=(20,20))
corr = df.corr()
sns.heatmap(corr,vmin=-1,vmax=1,annot=True)

## 상인과 소비자의 위도 경도 변수를 차이로 하여 새로운 변수 생성

df["lat_diff"] = abs(df['lat'] - df['merch_lat'])
df["long_diff"] = abs(df["long"] - df["merch_long"])
df.drop(['lat','merch_lat','long','merch_long'],axis=1,inplace=True)

## 위도 차이와 경도차이를 이용하여 거리변수를 생성
## 유클리디안 거리를 통해 거리 변수를 새로 만들어주었습니다
df['distance'] =  np.sqrt(pow(df["lat_diff"],2) + pow(df["long_diff"],2))
df.drop(['long_diff','lat_diff'],axis=1,inplace=True)

```


    
![png](output_11_0.png)
    



```python
# trans_date_trans_time : 트랜잭션 날짜 시간, dob : 신용카드 소지자의 생년월일
# 둘의 차이를 이용해 나이 계산
date_test = pd.to_datetime(df['trans_date_trans_time'], format='%Y-%m-%d').dt.strftime('%Y').astype(int)
date_test2 = pd.to_datetime(df['dob'], format='%Y-%m-%d').dt.strftime('%Y').astype(int)
df['age'] = date_test - date_test2
## dob 변수 제거
df.drop('dob',axis=1,inplace=True)
```


```python
### 같은 카드에서 다음 거래까지 걸린 시간의 차이를 단위(초)로 하여 나타냄
df["recency"] = df.groupby(by="cc_num")["unix_time"].diff()
print(df['recency'].value_counts())
df['recency'].fillna(0,inplace=True)  # 첫 거래에 있는 na값은 0으로 처리
df.drop("unix_time",1,inplace=True)
```


    ---------------------------------------------------------------------------

    KeyError                                  Traceback (most recent call last)

    ~\AppData\Local\Temp\ipykernel_33124\2199576857.py in <module>
          1 ### 같은 카드에서 다음 거래까지 걸린 시간의 차이를 단위(초)로 하여 나타냄
    ----> 2 df["recency"] = df.groupby(by="cc_num")["unix_time"].diff()
          3 print(df['recency'].value_counts())
          4 df['recency'].fillna(0,inplace=True)  # 첫 거래에 있는 na값은 0으로 처리
          5 df.drop("unix_time",1,inplace=True)
    

    c:\Users\msi\anaconda3\lib\site-packages\pandas\core\groupby\generic.py in __getitem__(self, key)
       1336                 stacklevel=find_stack_level(),
       1337             )
    -> 1338         return super().__getitem__(key)
       1339 
       1340     def _gotitem(self, key, ndim: int, subset=None):
    

    c:\Users\msi\anaconda3\lib\site-packages\pandas\core\base.py in __getitem__(self, key)
        248         else:
        249             if key not in self.obj:
    --> 250                 raise KeyError(f"Column not found: {key}")
        251             subset = self.obj[key]
        252             ndim = subset.ndim
    

    KeyError: 'Column not found: unix_time'



```python
## recency 값을 그룹화 하여 0이아닌 값에서
## 이상거래가 존재함을 확인 할 수 있다.
sns.kdeplot(df[df['is_fraud']==1]['recency'])
plt.show()

# 첫거래에서는 무조건 recency 값이 0으로 나오기 때문에 이때 이상값을 발견해낼수 있을지 의문이 듦
# recency 값이 0 각 카드로 처음 거래되었을때 이상거래로 확인된 비율
ratio = df[(df['is_fraud']==1) & (df['recency']==0)]["is_fraud"].sum()/len(df[df["recency"]==0]["is_fraud"])*100
print(f' recency 값이 0 각 카드로 처음 거래되었을때 이상거래로 확인된 비율 {ratio} %')
```


    
![png](output_14_0.png)
    


     recency 값이 0 각 카드로 처음 거래되었을때 이상거래로 확인된 비율 7.477567298105684 %
    


```python
# street , city, city_pop,state, zip 변수는 지역을 나타내는 변수로 이 지역의 규모를 범주화하여 변수를 만듬
# 대도시는 인구 50만명 이상, 중소도시는 10만명 이상에서 50만명 이하, 소도시는 10만명 이하로 구분하고 있다.
# 변수의 단위가 10으로 되어있음
df.loc[(df["city_pop"]<10000),["city_pop_category"]] = "소도시"
df.loc[((df["city_pop"]>10000) & (df["city_pop"]<50000)),["city_pop_category"]] = "중소도시"
df.loc[(df["city_pop"]>50000),["city_pop_category"]] = "대도시"

df.drop(['city','city_pop','street','zip'],axis=1,inplace=True)
df['city_pop_category'].value_counts()
```




    소도시     907611
    대도시     242674
    중소도시    146390
    Name: city_pop_category, dtype: int64




```python
## trans_date_trans_time 변수는 이 데이터 셋 자체가 과거의 데이터기 때문에 중요한 변수는 아닐것이라 생각한다
## 그러나 월별 ,시간 대 는 중요한 요소가 될수 있을것 같다.

## 거래 시간을 새 파생변수 'trans_hour'로 만든 후 시간 별 이상거래 확인 
df['trans_hour'] = pd.to_datetime(df['trans_date_trans_time']).dt.strftime('%H').astype(int)

# 21pm ~ 6am (12시간) 동안 많은 이상치가 발생하여 21pm ~ 6am을 '밤', 그 외의 시간을 '아침'으로 범주화 한 
df[df['is_fraud']==1].groupby('trans_hour')['is_fraud'].count().plot()
plt.show()

#새 파생변수 'trans_hour_category' 생성
df.loc[(df['trans_hour']>=7) & (df['trans_hour']<=20),'trans_hour_category'] = '아침'
df.loc[(df['trans_hour']>=21) | (df['trans_hour']<=6),'trans_hour_category'] = '밤'
df['trans_hour_category']



# 새로운 파생변수 month / trans_date_trans_time 시계열로 변경 후 월만 int형으로 출력
df['month'] = pd.to_datetime(df['trans_date_trans_time']).dt.strftime('%m').astype(int)

# 그래프 그리기
df[df['is_fraud']==1].groupby('month')['is_fraud'].count().plot()
plt.show()
# 데이터프래임으로 확인
df[df['is_fraud']==1].groupby('month')[['is_fraud']].count()

# 데이터 변경 함수
def change(x):
    if x < 6:
        result = '상반기'
    else:
        result = '하반기'
    return result

# 새로운 파생변수 half_month 1~6월 :상반기 7~12월 : 하반기
df['trans_month_category'] = df['month'].apply(change)

```


    
![png](output_16_0.png)
    



    
![png](output_16_1.png)
    



```python
## category 별 이상거래 횟수 확인

is_fraud = df[df["is_fraud"]==1]
sns.countplot(y=is_fraud.category)
plt.show()

##위 의 그래프에서 grocery_pos 와 shopping_net 목록에서 이상거래가 많이 발생한 것을 확인
## offlince grocery에서는 새벽시간 internet shopping 에는 밤시간에 이상거래로 관측된다
plt.figure(figsize=[12,6])
plt.subplot(121)
sns.kdeplot(x=is_fraud[is_fraud.category == "grocery_pos"].trans_hour)
plt.xlim(left=0,right=24)
plt.title(label = "Offline Grocery Transactions Frauds")
plt.subplot(122)
sns.kdeplot(x=is_fraud[is_fraud.category == "shopping_net"].trans_hour)
plt.title(label = "Internet Shopping Transactions Frauds")
plt.xlim(left=0,right=24)
plt.show()
```


    
![png](output_17_0.png)
    



    ---------------------------------------------------------------------------

    AttributeError                            Traceback (most recent call last)

    ~\AppData\Local\Temp\ipykernel_33124\2587951938.py in <module>
          9 plt.figure(figsize=[12,6])
         10 plt.subplot(121)
    ---> 11 sns.kdeplot(x=is_fraud[is_fraud.category == "grocery_pos"].trans_hour)
         12 plt.xlim(left=0,right=24)
         13 plt.title(label = "Offline Grocery Transactions Frauds")
    

    c:\Users\msi\anaconda3\lib\site-packages\pandas\core\generic.py in __getattr__(self, name)
       5573         ):
       5574             return self[name]
    -> 5575         return object.__getattribute__(self, name)
       5576 
       5577     def __setattr__(self, name: str, value) -> None:
    

    AttributeError: 'DataFrame' object has no attribute 'trans_hour'



    
![png](output_17_2.png)
    



```python
# 기존 month 컬럼 삭제
df.drop(['month','trans_hour','trans_date_trans_time'], axis=1, inplace=True)
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1296675 entries, 0 to 1296674
    Data columns (total 16 columns):
     #   Column                 Non-Null Count    Dtype  
    ---  ------                 --------------    -----  
     0   trans_date_trans_time  1296675 non-null  object 
     1   cc_num                 1296675 non-null  int64  
     2   merchant               1296675 non-null  object 
     3   category               1296675 non-null  object 
     4   amt                    1296675 non-null  float64
     5   gender                 1296675 non-null  object 
     6   job                    1296675 non-null  object 
     7   is_fraud               1296675 non-null  int64  
     8   distance               1296675 non-null  float64
     9   age                    1296675 non-null  int32  
     10  recency                1296675 non-null  float64
     11  city_pop_category      1296675 non-null  object 
     12  trans_hour             1296675 non-null  int32  
     13  trans_hour_category    1296675 non-null  object 
     14  month                  1296675 non-null  int32  
     15  trans_month_category   1296675 non-null  object 
    dtypes: float64(3), int32(3), int64(2), object(8)
    memory usage: 143.4+ MB
    


```python
df.info()
## jop state category merchat 변수 처리 계획
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1296675 entries, 0 to 1296674
    Data columns (total 14 columns):
     #   Column                Non-Null Count    Dtype  
    ---  ------                --------------    -----  
     0   cc_num                1296675 non-null  int64  
     1   merchant              1296675 non-null  object 
     2   category              1296675 non-null  object 
     3   amt                   1296675 non-null  float64
     4   gender                1296675 non-null  object 
     5   state                 1296675 non-null  object 
     6   job                   1296675 non-null  object 
     7   is_fraud              1296675 non-null  int64  
     8   distance              1296675 non-null  float64
     9   age                   1296675 non-null  int32  
     10  recency               1296675 non-null  float64
     11  city_pop_category     1296675 non-null  object 
     12  trans_hour_category   1296675 non-null  object 
     13  trans_month_category  1296675 non-null  object 
    dtypes: float64(3), int32(1), int64(2), object(8)
    memory usage: 133.6+ MB
    


```python
# 상관계수가 높은 변수 확인
plt.figure(figsize=(20,20))
corr = df.corr()
sns.heatmap(corr,vmin=-1,vmax=1,annot=True)
```




    <AxesSubplot:>




    
![png](output_20_1.png)
    



```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cc_num</th>
      <th>amt</th>
      <th>is_fraud</th>
      <th>distance</th>
      <th>age</th>
      <th>recency</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
      <td>1.296675e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.171920e+17</td>
      <td>7.035104e+01</td>
      <td>5.788652e-03</td>
      <td>7.656611e-01</td>
      <td>4.602930e+01</td>
      <td>3.246039e+04</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.308806e+18</td>
      <td>1.603160e+02</td>
      <td>7.586269e-02</td>
      <td>2.847484e-01</td>
      <td>1.738237e+01</td>
      <td>4.733114e+04</td>
    </tr>
    <tr>
      <th>min</th>
      <td>6.041621e+10</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>2.386629e-04</td>
      <td>1.400000e+01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.800429e+14</td>
      <td>9.650000e+00</td>
      <td>0.000000e+00</td>
      <td>5.649579e-01</td>
      <td>3.300000e+01</td>
      <td>6.004000e+03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.521417e+15</td>
      <td>4.752000e+01</td>
      <td>0.000000e+00</td>
      <td>7.983111e-01</td>
      <td>4.400000e+01</td>
      <td>1.656300e+04</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.642255e+15</td>
      <td>8.314000e+01</td>
      <td>0.000000e+00</td>
      <td>9.775357e-01</td>
      <td>5.700000e+01</td>
      <td>4.023900e+04</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.992346e+18</td>
      <td>2.894890e+04</td>
      <td>1.000000e+00</td>
      <td>1.413364e+00</td>
      <td>9.600000e+01</td>
      <td>1.341471e+06</td>
    </tr>
  </tbody>
</table>
</div>




```python

```
